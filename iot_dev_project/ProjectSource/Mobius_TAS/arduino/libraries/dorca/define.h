/*
 *    define.h -- DORCA20 FPGA TEST DEFINE HEADER FILE
 *
 * Copyright (C) 2014 Kim, Yongjae.
 * Copyright (C) 2014 Neowine. Co,Ltd.
 *
 * Version : 0.1
 * Compiler: ADS v1.2 Build[848]
 * Author: Kim, Yongjae.
 * Date  : 27.September.2014
 */

/*********************** yjkim DEFINES ************************/
#define random(n) (rand()%(n))

#define ERROR 0xFF

#if 1
//--- Newonsys  uSD
unsigned char group_id[4]          = { 0xF0, 0xDA, 0xCF, 0x35 };    // Bank 0   GID
unsigned char user_id[4]           = { 0x71, 0x40, 0x2F, 0xB2 };    // Bank 1   UID
unsigned char user_serial_h[4]     = { 0xF5, 0xCB, 0x40, 0xDD };    // Bank 2   User Serial MSB
unsigned char user_serial_l[4]     = { 0x00, 0x00, 0x00, 0x00 };    // Bank 3   User Serial LSB
#elif 0   // 동원 T&I - 003
    unsigned char group_id[4]      = { 0x69, 0xC6, 0x9D, 0x5E };    // Bank 0   GID
    unsigned char user_id[4]       = { 0x29, 0xBD, 0x10, 0x64 };    // Bank 1   UID
    unsigned char user_serial_h[4] = { 0x59, 0x74, 0xA2, 0x19 };    // Bank 2   User Serial MSB
    unsigned char user_serial_l[4] = { 0x00, 0x00, 0x00, 0x00 };    // Bank 3   User Serial LSB
#else   // 베프스 - 004
    unsigned char group_id[4]      = { 0xCD, 0x18, 0x7A, 0x16 };    // Bank 0   GID
    unsigned char user_id[4]       = { 0x6F, 0x90, 0x4C, 0xA6 };    // Bank 1   UID
    unsigned char user_serial_h[4] = { 0x21, 0x35, 0x21, 0xAB };    // Bank 2   User Serial MSB
    unsigned char user_serial_l[4] = { 0x00, 0x00, 0x00, 0x00 };    // Bank 3   User Serial LSB
#endif
 
#if 0
//--- Device 1 OTP Value
unsigned char OTP_DATA_BANK_00[4] = { 0x00, 0x12, 0x34, 0x54 } ;
unsigned char OTP_DATA_BANK_01[4] = { 0x0e, 0x0e, 0x0e, 0x0e } ;
unsigned char OTP_DATA_BANK_02[4] = { 0x0d, 0x0d, 0x0d, 0x0d } ;
unsigned char OTP_DATA_BANK_03[4] = { 0x0c, 0x0c, 0x0c, 0x0c } ;

//--- Device 2 OTP Value
unsigned char OTP_DATA_BANK_10[4] = { 0x00, 0x12, 0x34, 0x54 } ;
unsigned char OTP_DATA_BANK_11[4] = { 0x0c, 0x0c, 0x0c, 0x0c } ;
unsigned char OTP_DATA_BANK_12[4] = { 0x0d, 0x0d, 0x0d, 0x0d } ;
unsigned char OTP_DATA_BANK_13[4] = { 0x0e, 0x0e, 0x0e, 0x0e } ;
#endif



//--- Additional by Justin 2014.10.02
unsigned char cipher_result[16] = { 0x00, } ;
unsigned char decipher_result[16] = { 0x00, } ;
//--------------------------------------------------------------------

unsigned char zero[1] ={0x00};
unsigned char one[1] = {0x01};
unsigned char three[1] = {0x03};
unsigned char four[1] = {0x04};
unsigned char five[1] = {0x05};
unsigned char sixteen[1] = {0x10};
unsigned char F0[1] = {0xf0};
unsigned char FF[1] = {0xff};
unsigned char thirtytwo[1] = {0x20};
unsigned char sixtyfour[1] = {0x40};
unsigned char ahundred[1] = {0x64};

unsigned char BK_SEL_WR_3[1] = {0x07};
unsigned char BK_SEL_WR_2[1] = {0x06};
unsigned char BK_SEL_WR_1[1] = {0x05};
unsigned char BK_SEL_WR_0[1] = {0x04};

unsigned char BK_SEL_RD_3[1] = {0x03};
unsigned char BK_SEL_RD_2[1] = {0x02};
unsigned char BK_SEL_RD_1[1] = {0x01};
unsigned char BK_SEL_RD_0[1] = {0x00};

unsigned char OTP128_INIT_3[4] ={0x00, };
unsigned char OTP128_INIT_2[4] ={0x00, };
unsigned char OTP128_INIT_1[4] ={0x00, };
unsigned char OTP128_INIT_0[4] ={0x00, };

unsigned char ERROR_CODE_AUTH_OTP_RD = 0;
unsigned char ERROR_CODE_AUTH_OTP1_RD = 1;
unsigned char ERROR_CODE_AUTH_OTP23_RD = 2;
unsigned char ERROR_CODE_OTP_READ = 3;
unsigned char ERROR_CODE_AUTH_OTP0_RD = 4;

/*********************** SFR.V DEFINES ************************/

#define RG_ENC_IN_0             0x00
#define RG_ENC_IN_1             0x01
#define RG_ENC_IN_2             0x02
#define RG_ENC_IN_3             0x03
#define RG_ENC_IN_4             0x04
#define RG_ENC_IN_5             0x05
#define RG_ENC_IN_6             0x06
#define RG_ENC_IN_7             0x07
#define RG_ENC_IN_8             0x08
#define RG_ENC_IN_9             0x09
#define RG_ENC_IN_A             0x0A
#define RG_ENC_IN_B             0x0B
#define RG_ENC_IN_C             0x0C
#define RG_ENC_IN_D             0x0D
#define RG_ENC_IN_E             0x0E
#define RG_ENC_IN_F             0x0F

#define RG_DEC_IN_0             0x10
#define RG_DEC_IN_1             0x11
#define RG_DEC_IN_2             0x12
#define RG_DEC_IN_3             0x13
#define RG_DEC_IN_4             0x14
#define RG_DEC_IN_5             0x15
#define RG_DEC_IN_6             0x16
#define RG_DEC_IN_7             0x17
#define RG_DEC_IN_8             0x18
#define RG_DEC_IN_9             0x19
#define RG_DEC_IN_A             0x1A
#define RG_DEC_IN_B             0x1B
#define RG_DEC_IN_C             0x1C
#define RG_DEC_IN_D             0x1D
#define RG_DEC_IN_E             0x1E
#define RG_DEC_IN_F             0x1F

#define RG_OBUF_ENC_0           0x20
#define RG_OBUF_ENC_1           0x21
#define RG_OBUF_ENC_2           0x22
#define RG_OBUF_ENC_3           0x23
#define RG_OBUF_ENC_4           0x24
#define RG_OBUF_ENC_5           0x25
#define RG_OBUF_ENC_6           0x26
#define RG_OBUF_ENC_7           0x27
#define RG_OBUF_ENC_8           0x28
#define RG_OBUF_ENC_9           0x29
#define RG_OBUF_ENC_A           0x2A
#define RG_OBUF_ENC_B           0x2B
#define RG_OBUF_ENC_C           0x2C
#define RG_OBUF_ENC_D           0x2D
#define RG_OBUF_ENC_E           0x2E
#define RG_OBUF_ENC_F           0x2F

#define RG_OBUF_DEC_0           0x30
#define RG_OBUF_DEC_1           0x31
#define RG_OBUF_DEC_2           0x32
#define RG_OBUF_DEC_3           0x33
#define RG_OBUF_DEC_4           0x34
#define RG_OBUF_DEC_5           0x35
#define RG_OBUF_DEC_6           0x36
#define RG_OBUF_DEC_7           0x37
#define RG_OBUF_DEC_8           0x38
#define RG_OBUF_DEC_9           0x39
#define RG_OBUF_DEC_A           0x3A
#define RG_OBUF_DEC_B           0x3B
#define RG_OBUF_DEC_C           0x3C
#define RG_OBUF_DEC_D           0x3D
#define RG_OBUF_DEC_E           0x3E
#define RG_OBUF_DEC_F           0x3F

#define RG_DTOP_VER0            0x40
#define RG_DTOP_VER1            0x41
#define RG_DTOP_VER2            0x42
#define RG_DTOP_VER3            0x43

#define RG_SOFT_RESET           0x44
#define RG_BYPASS               0x45
#define RG_BUSY                 0x46
//#define RG_SLEEP_TIMER_MSB      0x47

//#define RG_SLEEP_TIMER_LSB      0x48
#define RG_KEY_GEN              0x49
#define RG_KEY_DONE             0x4A
#define RG_KEY_REV              0x4B

#define RG_KEY_MUX              0x4C
#define RG_TEXT_MUX             0x4D
#define RG_F_KEY_SET            0x4E

#define RG_F_CP_OENC_ODEC       0x60
#define RG_F_CP_ODEC_OENC       0x61
#define RG_F_CLR_OBUF_ENC       0x62
#define RG_F_CLR_OBUF_DEC       0x63

#define RG_F_AES_KG             0x64

#define RG_TVALUE1              0x68
#define RG_TVALUE2              0x69
#define RG_TVALUE3              0x6A
#define RG_TVALUE4              0x6B

#define RG_TVALUE5              0x6C
#define RG_TVALUE6              0x6D
#define RG_TVALUE7              0x6E

#define RG_OTP_DATA0            0x70
#define RG_OTP_DATA1            0x71
#define RG_OTP_DATA2            0x72
#define RG_OTP_DATA3            0x73
#define RG_OTP_BANK_CTRL        0x74
#define RG_OTP_RD               0x75

#define RG_LFSR_CYCLE           0x78
#define RG_LFSR_CTRL            0x79
#define RG_LFSR_CTRL2           0x7A

#define RG_AUTH_OTP23           0xB0
#define RG_AUTH_OTP1            0xB1

#define RG_STATE_INIT           0xBB

#define RG_H_STATE              0xBC
#define RG_AUTH_LFSR_INIT_VAL   0xBD
#define RG_AUTH_OTP0            0xBE
#define RG_ACC                  0xBF

#define RG_KEY_IN_0             0xC0
#define RG_KEY_IN_1             0xC1
#define RG_KEY_IN_2             0xC2
#define RG_KEY_IN_3             0xC3
#define RG_KEY_IN_4             0xC4
#define RG_KEY_IN_5             0xC5
#define RG_KEY_IN_6             0xC6
#define RG_KEY_IN_7             0xC7
#define RG_KEY_IN_8             0xC8
#define RG_KEY_IN_9             0xC9
#define RG_KEY_IN_A             0xCA
#define RG_KEY_IN_B             0xCB
#define RG_KEY_IN_C             0xCC
#define RG_KEY_IN_D             0xCD
#define RG_KEY_IN_E             0xCE
#define RG_KEY_IN_F             0xCF

#define RG_LFSR_INIT_VAL_0      0xD0
#define RG_LFSR_INIT_VAL_1      0xD1
#define RG_LFSR_INIT_VAL_2      0xD2
#define RG_LFSR_INIT_VAL_3      0xD3
#define RG_LFSR_INIT_VAL_4      0xD4
#define RG_LFSR_INIT_VAL_5      0xD5
#define RG_LFSR_INIT_VAL_6      0xD6
#define RG_LFSR_INIT_VAL_7      0xD7
#define RG_LFSR_INIT_VAL_8      0xD8
#define RG_LFSR_INIT_VAL_9      0xD9
#define RG_LFSR_INIT_VAL_A      0xDA
#define RG_LFSR_INIT_VAL_B      0xDB
#define RG_LFSR_INIT_VAL_C      0xDC
#define RG_LFSR_INIT_VAL_D      0xDD
#define RG_LFSR_INIT_VAL_E      0xDE
#define RG_LFSR_INIT_VAL_F      0xDF

#define RG_IBUF_TEXT_0          0xE0
#define RG_IBUF_TEXT_1          0xE1
#define RG_IBUF_TEXT_2          0xE2
#define RG_IBUF_TEXT_3          0xE3
#define RG_IBUF_TEXT_4          0xE4
#define RG_IBUF_TEXT_5          0xE5
#define RG_IBUF_TEXT_6          0xE6
#define RG_IBUF_TEXT_7          0xE7
#define RG_IBUF_TEXT_8          0xE8
#define RG_IBUF_TEXT_9          0xE9
#define RG_IBUF_TEXT_A          0xEA
#define RG_IBUF_TEXT_B          0xEB
#define RG_IBUF_TEXT_C          0xEC
#define RG_IBUF_TEXT_D          0xED
#define RG_IBUF_TEXT_E          0xEE
#define RG_IBUF_TEXT_F          0xEF

#define RG_IBUF_KEY_0           0xF0
#define RG_IBUF_KEY_1           0xF1
#define RG_IBUF_KEY_2           0xF2
#define RG_IBUF_KEY_3           0xF3
#define RG_IBUF_KEY_4           0xF4
#define RG_IBUF_KEY_5           0xF5
#define RG_IBUF_KEY_6           0xF6
#define RG_IBUF_KEY_7           0xF7
#define RG_IBUF_KEY_8           0xF8
#define RG_IBUF_KEY_9           0xF9
#define RG_IBUF_KEY_A           0xFA
#define RG_IBUF_KEY_B           0xFB
#define RG_IBUF_KEY_C           0xFC
#define RG_IBUF_KEY_D           0xFD
#define RG_IBUF_KEY_E           0xFE
#define RG_IBUF_KEY_F           0xFF

/*********************** OP_SM.V DEFINES ************************/

unsigned char PW_KEY_OTP0[16] = {0xA3, 0x98, 0x93, 0x8B, 0x39, 0x4F, 0xE9, 0x00, 0x84, 0x90, 0x98, 0x90, 0x88, 0x89, 0x83, 0x80};
unsigned char PW_OTP1[16] = {0xB9, 0x90, 0x93, 0x9C, 0x09, 0x09, 0x84, 0x7E, 0x12, 0x99, 0x39, 0x34, 0x32, 0x94, 0x93, 0x99};
unsigned char PW_OTP23[16] = {0xC0, 0x00, 0x90, 0x49, 0x99, 0x9C, 0x99, 0x7B, 0x49, 0x80, 0x98, 0x98, 0x00, 0x09, 0x29, 0x99};
unsigned char PW_LFSR_INIT_VAL[16] = {0xD3, 0x0C, 0x90, 0x9B, 0x39, 0x8F, 0x93, 0x9D, 0x39, 0x99, 0x09, 0x00, 0x99, 0x92, 0x99, 0x94};
unsigned char PS1A[16] = {0x71, 0xf2, 0x6f, 0x23, 0xe1, 0x53, 0x40, 0x0b, 0x74, 0xda, 0xf7, 0xd9, 0x25, 0x40, 0x2e, 0x41};
unsigned char PS1B[16] = {0x4a, 0x60, 0x69, 0xd4, 0x30, 0xa2, 0x4d, 0xb0, 0xa2, 0xca, 0x6f, 0xc9, 0xea, 0xff, 0xfe, 0xe2};

/*********************** TB_KMS3.V DEFINES ************************/

unsigned char iOTP_C_A[16] = {0x0C, 0x0C, 0x0C, 0x0C, 0x0D, 0x0D, 0x0D, 0x0D, 0x0E, 0x0E, 0x0E, 0x0E, 0x00, 0x12, 0x34, 0x50};

unsigned char iOTP_C_A_3[1] = {0x0C};
unsigned char iOTP_C_A_2[1] = {0x0D};
unsigned char iOTP_C_A_1[1] = {0x0E};
unsigned char iOTP_C_A_0[1] = {0x00};
unsigned char iOTP_C_A_0_3[1] = {0x00};
unsigned char iOTP_C_A_0_2[1] = {0x12};
unsigned char iOTP_C_A_0_1[1] = {0x34};
unsigned char iOTP_C_A_0_0[1] = {0x54};

unsigned char OTP128_INIT[1] = {0x00};

unsigned char iRA[16] = {0xAA, 0xAA, 0xAA, 0xAA, 0xAA, 0xAA, 0xAA, 0xAA, 0xAA, 0xAA, 0xAA, 0xAA, 0xAA, 0xAA, 0xAA, 0xAA};
unsigned char ps1A[16] = {0x71, 0xf2, 0x6f, 0x23, 0xe1, 0x53, 0x40, 0x0b, 0x74, 0xda, 0xf7, 0xd9, 0x25, 0x40, 0x2e, 0x41};
unsigned char ps1B[16] = {0x4a, 0x60, 0x69, 0xd4, 0x30, 0xa2, 0x4d, 0xb0, 0xa2, 0xca, 0x6f, 0xc9, 0xea, 0xff, 0xfe, 0xe2};
unsigned char ps1AXps1B[16];
unsigned char ps2A[16] = {0x94, 0xf8, 0x6e, 0x47, 0x99, 0x50, 0x4f, 0x9b, 0x1b, 0x67, 0x91, 0x7e, 0x28, 0x90, 0x1f, 0x41};
unsigned char ps2B[16] = {0x6c, 0x70, 0xca, 0xd5,  0x2a, 0x53, 0xc7, 0x20, 0x3c, 0x5a, 0x95, 0xf8, 0xbd, 0x64, 0xbd, 0x61};
unsigned char ipKEY[16] = {0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55}; 
unsigned char ipTEXT[16] = {0x66, 0x66, 0x66, 0x66, 0x66, 0x66, 0x66, 0x66, 0x66, 0x66, 0x66, 0x66, 0x66, 0x66, 0x66, 0x66}; 
unsigned char FK[16] = {0xb9, 0x73, 0x1f, 0xd0, 0xbd, 0x92, 0xdf, 0x89, 0x7d, 0xf4, 0xa4, 0xa5, 0x04, 0x14, 0x98, 0xe5};
unsigned char oE1[16] = {0x63, 0x2f, 0x81, 0x18, 0xfd, 0x15, 0x0c, 0xde, 0x66, 0xd5, 0x6e, 0xa4, 0x9c, 0x8d, 0x6c, 0xa6};
unsigned char oD1[16] = {0x62, 0xfb, 0x03, 0x23, 0xa5, 0xe3, 0x91, 0xb1, 0x7b, 0xc7, 0xcf, 0x77, 0x67, 0x36, 0xba, 0x24};
unsigned char oE1PoD1[32] = {0x63, 0x2f, 0x81, 0x18, 0xfd, 0x15, 0x0c, 0xde, 0x66, 0xd5, 0x6e, 0xa4, 0x9c, 0x8d, 0x6c, 0xa6, 0x62, 0xfb, 0x03, 0x23, 0xa5, 0xe3, 0x91, 0xb1, 0x7b, 0xc7, 0xcf, 0x77, 0x67, 0x36, 0xba, 0x24};
unsigned char oET1[16] = {0x80, 0xf7, 0x81, 0xfe, 0x94, 0x3c, 0xac, 0x03, 0xf3, 0x1a, 0x07, 0x88, 0xf7, 0x7c, 0xbf, 0x66};
unsigned char oDT1[16] = {0x56, 0xd9, 0x09, 0xd3, 0x1e, 0x04, 0xa4, 0x6e, 0x96, 0x46, 0x1f, 0xf9, 0x22, 0xd2, 0xf0, 0xe8};
unsigned char oET1PoDT1[32] ={0x80, 0xf7, 0x81, 0xfe, 0x94, 0x3c, 0xac, 0x03, 0xf3, 0x1a, 0x07, 0x88, 0xf7, 0x7c, 0xbf, 0x66, 0x56, 0xd9, 0x09, 0xd3, 0x1e, 0x04, 0xa4, 0x6e, 0x96, 0x46, 0x1f, 0xf9, 0x22, 0xd2, 0xf0, 0xe8};
unsigned char iU1[32] = {0x70, 0x71, 0x72, 0x73, 0x74, 0x75, 0x76, 0x77, 0x78, 0x79, 0x7a, 0x7b, 0x7c, 0x7d, 0x7e, 0x7f, 0x70, 0x71, 0x72, 0x73, 0x74, 0x75, 0x76, 0x77, 0x78, 0x79, 0x7a, 0x7b, 0x7c, 0x7d, 0x7e, 0x7f};
unsigned char lfsr_init_val[16] = {0xb0, 0xb1, 0xb2, 0xb3, 0xb4, 0xb5, 0xb6, 0xb7, 0xb8, 0xb9, 0xba, 0xbb, 0xbc, 0xbd, 0xbe, 0xbf};
//unsigned char lfsr_init_val[16] = {0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x12, 0x34, 0x56, 0x78};
unsigned char lfsr_init_val_comp[16] = {0xb0, 0xb1, 0xb2, 0xb3, 0xb4, 0xb5, 0xb6, 0xb7, 0xb8, 0xb9, 0xba, 0xbb, 0x00, 0x00, 0x00, 0x00};
unsigned char BYPASS_XOR_PT[32] = {0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01} ;
unsigned char BYPASS_XOR_PTXiU1[32];

unsigned char lfsr_init_val_store[16];
unsigned char ibuf_text[16];
unsigned char ibuf_key[16];

unsigned char KB_DONE[1] = {0x01};
unsigned char FK_DONE[1] = {0x10};
unsigned char TVALUE0[1] = {0xff};
unsigned char TVALUE1[1] = {0xf8};


